source(output(
		Row as string,
		Timestamp as string,
		Gender as string,
		Country as string,
		Occupation as string,
		self_employed as string,
		family_history as string,
		treatment as string,
		Days_Indoors as string,
		Growing_Stress as string,
		Changes_Habits as string,
		Mental_Health_History as string,
		Mood_Swings as string,
		Coping_Struggles as string,
		Work_Interest as string,
		Social_Weakness as string,
		mental_health_interview as string,
		care_options as string
	),
	allowSchemaDrift: true,
	validateSchema: false,
	ignoreNoFilesFound: false) ~> BlobDataMentalHealth
BlobDataMentalHealth split(contains(array(toString(columns())),isNull(#item)),
	disjoint: false) ~> LookForNULLs@(hasNULLs, noNULLs)
LookForNULLs@noNULLs derive(Continent = case(
    (Country == 'United States' || Country == 'Brazil' || Country == 'Canada' || Country == 'Colombia' || Country == 'Costa Rica' || Country == 'Mexico'), 'America',
    (Country == 'Australia' || Country == 'New Zealand'), 'Oceania',
    (Country == 'Belgium' || Country == 'Bosnia and Herzegovina' || Country == 'Croatia' || Country == 'Czech Republic' || Country == 'Denmark' || Country == 'Finland' || Country == 'France' || Country == 'Germany' || Country == 'Geece' || Country == 'Ireland' || Country == 'Italy' || Country == 'Moldova' || Country == 'Netherlands' || Country == 'Poland' || Country == 'Portugal' || Country == 'Sweden' || Country == 'Switzerland' || Country == 'United Kingdom'), 'Europe',
    (Country == 'Georgia' || Country == 'Russia'), 'Europe/Asia',
    (Country == 'India' || Country == 'Israel' || Country == 'Philippines' || Country == 'Singapore' || Country == 'Thailand'), 'Asia',
    (Country == 'Nigeria' || Country == 'South Africa'), 'Africa'
)) ~> ContinentColumn
ContinentColumn sink(allowSchemaDrift: true,
	validateSchema: false,
	input(
		row_id as integer,
		time_stamp as timestamp,
		gender as string,
		country as string,
		occupation as string,
		self_employed as string,
		family_history as string,
		treatment as string,
		days_indoors as string,
		growing_stress as string,
		changes_habits as string,
		mental_health_history as string,
		mood_swings as string,
		coping_struggles as string,
		work_interest as string,
		social_weakness as string,
		mental_health_interview as string,
		care_options as string,
		continent as string
	),
	deletable:false,
	insertable:true,
	updateable:false,
	upsertable:false,
	format: 'table',
	staged: true,
	allowCopyCommand: true,
	skipDuplicateMapInputs: true,
	skipDuplicateMapOutputs: true,
	errorHandlingOption: 'stopOnFirstError') ~> ToSynapse